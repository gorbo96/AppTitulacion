{"version":3,"file":"src_app_pages_admin_update-family_update-family_module_ts.js","mappings":"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","sources":["./src/app/pages/admin/update-family/update-family-routing.module.ts","./src/app/pages/admin/update-family/update-family.module.ts","./src/app/pages/admin/update-family/update-family.page.ts"],"sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { Routes, RouterModule } from '@angular/router';\r\n\r\nimport { UpdateFamilyPage } from './update-family.page';\r\n\r\nconst routes: Routes = [\r\n  {\r\n    path: '',\r\n    component: UpdateFamilyPage\r\n  }\r\n];\r\n\r\n@NgModule({\r\n  imports: [RouterModule.forChild(routes)],\r\n  exports: [RouterModule],\r\n})\r\nexport class UpdateFamilyPageRoutingModule {}\r\n","import { NgModule } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { FormsModule } from '@angular/forms';\r\n\r\nimport { IonicModule } from '@ionic/angular';\r\n\r\nimport { UpdateFamilyPageRoutingModule } from './update-family-routing.module';\r\n\r\nimport { UpdateFamilyPage } from './update-family.page';\r\n\r\n@NgModule({\r\n  imports: [\r\n    CommonModule,\r\n    FormsModule,\r\n    IonicModule,\r\n    UpdateFamilyPageRoutingModule\r\n  ],\r\n  declarations: [UpdateFamilyPage]\r\n})\r\nexport class UpdateFamilyPageModule {}\r\n","import { Component, OnInit } from '@angular/core';\r\nimport { ActivatedRoute, NavigationExtras, Router } from '@angular/router';\r\nimport { AuthenticationService } from 'src/app/services/authentication.service';\r\nimport { Familia } from 'src/app/domain/family';\r\nimport { take } from 'rxjs/operators';\r\nimport { AlertController, LoadingController } from '@ionic/angular';\r\n\r\n@Component({\r\n  selector: 'app-update-family',\r\n  templateUrl: './update-family.page.html',\r\n  styleUrls: ['./update-family.page.scss'],\r\n})\r\nexport class UpdateFamilyPage implements OnInit {\r\n\r\n  private fam: Familia = new Familia()\r\n  private aux: any\r\n\r\n  user: any\r\n  id:any\r\n  nombre:any\r\n  presupuesto_global:any\r\n  primer_dia_mes:any\r\n\r\n  alert: string\r\n  advice: string\r\n  header: string\r\n\r\n  private sessionUser : any\r\n\r\n  constructor(  private router: Router, \r\n                private auth :  AuthenticationService, \r\n                private alertCtrl: AlertController, \r\n                private activate: ActivatedRoute,\r\n                private loadingController: LoadingController ) { }\r\n\r\n  async ngOnInit() {\r\n\r\n    // Control de la interacción del usuario usando una rueda de carga\r\n    return await this.loadingController.create({ }).then(a => {\r\n      a.present().then(async () => {\r\n        \r\n        // Obtención del usuario que actualmente tiene la sesión abierta\r\n        this.sessionUser = await this.auth.getUserAuth()\r\n\r\n        await this.sessionUser.pipe(take(1)).subscribe(async user =>{\r\n\r\n          // Obtener los datos del usurio de FireStore dado- \r\n          //    el email proporcionado por la API de autentificación\r\n          this.user = await this.auth.getUsuario(user.email)\r\n\r\n          await this.user.pipe(take(1)).subscribe(async res=> {\r\n            \r\n            this.aux = await this.auth.getFamily(res[0].id_familia)\r\n\r\n            await this.aux.pipe(take(1)).subscribe( res2=> {\r\n              this.id = res2[0].id\r\n              this.nombre= res2[0].nombre\r\n              this.presupuesto_global = res2[0].presupuesto_global\r\n              this.primer_dia_mes = res2[0].primer_dia_mes\r\n\r\n              a.dismiss().then(() => console.log('abort presenting'));\r\n              \r\n            })\r\n\r\n          })\r\n\r\n        })\r\n        \r\n      });\r\n    });\r\n\r\n  }\r\n\r\n  async dismiss() {\r\n    return await this.loadingController.dismiss().then(() => console.log('dismissed'));\r\n  }\r\n\r\n  async update(email) {\r\n    return await this.loadingController.create({ }).then(a => {\r\n      a.present().then(async () => {\r\n        try {\r\n      \r\n          this.fam.id = this.id\r\n          this.fam.nombre = this.nombre\r\n          this.fam.presupuesto_global = this.presupuesto_global\r\n          this.fam.primer_dia_mes = this.primer_dia_mes\r\n    \r\n          //console.log(this.fam)\r\n    \r\n          this.auth.updateFamily(this.fam)\r\n          a.dismiss().then(() => console.log('abort presenting'));\r\n    \r\n          this.header = 'Listo'\r\n          this.alert = \"\"\r\n          this.advice = 'Datos actualizados correctamente'\r\n          this.genericAlert(this.header, this.alert, this.advice)\r\n    \r\n          return this.router.navigate([\"/tabs\"]);\r\n    \r\n        } catch (error) {\r\n          console.log(\"error al asignar familia\")\r\n    \r\n          this.header = 'Lo sentimos'\r\n          this.alert = \"Ocurrió un error inesperado al ingresar su familia\"\r\n          this.advice = 'Por favor, inténtelo de nuevo'\r\n    \r\n          return this.genericAlert(this.header, this.alert, this.advice)\r\n    \r\n        }\r\n      })\r\n    })\r\n\r\n  }\r\n\r\n  regresar(){\r\n    this.router.navigate([\"/login\"])\r\n  }\r\n\r\n  async genericAlert(header, alert_message, advice){\r\n\r\n    const prompt = await this.alertCtrl.create({  \r\n      header: header,  \r\n      subHeader: alert_message,\r\n      message: advice,  \r\n      \r\n      buttons: ['Aceptar']  \r\n    }); \r\n\r\n    await prompt.present()\r\n\r\n  }\r\n\r\n}\r\n"],"names":[],"sourceRoot":"webpack:///"}